<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ç‹æ¬£æ€¡ï¼Œæˆ‘ä»¬è§ä¸€é¢å¥½ä¸å¥½ï¼Ÿ</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body, html {
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      font-family: å¾®è½¯é›…é»‘;
      position: relative;
    }
    /* å…¨å±å¼¹çª— */
    .popup {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: linear-gradient(135deg, #ffebf0, #ffd1dc);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-start;
      z-index: 9999;
      text-align: left;
      padding: 0 50px;
      transition: opacity 0.8s ease;
    }
    /* é¡¶éƒ¨æ ‡è¯­ï¼ˆæ”¯æŒåŠ¨æ€åˆ‡æ¢ï¼‰ */
    .title {
      font-size: 38px;
      color: #ff3e78;
      font-weight: bold;
      margin-bottom: 50px;
      text-shadow: 0 2px 4px rgba(255,62,120,0.3);
      transition: all 0.5s ease;
    }
    /* æ ¸å¿ƒå†…å®¹å®¹å™¨ï¼ˆè¡¨æƒ…+æ¥å—æŒ‰é’®ï¼‰ */
    .content-wrapper {
      display: flex;
      align-items: center;
      gap: 40px;
      transition: transform 0.5s ease;
    }
    /* è¡¨æƒ…åŒ… */
    .emoji {
      font-size: 110px;
      transition: all 0.5s ease;
    }
    /* æŒ‰é’®æ ·å¼ */
    .btn {
      padding: 18px 45px;
      border: none;
      border-radius: 50px;
      font-size: 24px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      white-space: nowrap;
      transform-origin: center;
    }
    .accept-btn {
      background: #4cd964;
      color: white;
      box-shadow: 0 4px 15px rgba(76,217,100,0.4);
    }
    .accept-btn:hover {
      background: #3ac152;
      transform: scale(1.05);
    }
    .refuse-btn {
      position: fixed;
      right: 50px;
      top: 50%;
      transform: translateY(-50%) scale(1);
      background: #ff3b30;
      color: white;
      box-shadow: 0 4px 15px rgba(255,59,48,0.4);
      max-width: 300px;
    }
    .refuse-btn:hover {
      background: #e03024;
    }
    /* é›ªèŠ±æ ·å¼ */
    .snowflake {
      position: absolute;
      color: #fff;
      font-size: 16px;
      opacity: 0.8;
      pointer-events: none;
      animation: snowfall linear infinite;
      z-index: 9998;
    }
    /* çˆ±å¿ƒæ ·å¼ */
    .heart {
      position: absolute;
      color: #ff3e78;
      font-size: 20px;
      opacity: 0.9;
      pointer-events: none;
      animation: heartFloat 4s ease-in-out infinite;
      text-shadow: 0 0 8px #ff3e78;
      z-index: 10000;
    }
    /* é›ªèŠ±é£˜è½åŠ¨ç”» */
    @keyframes snowfall {
      0% { transform: translateY(-10px) rotate(0deg); opacity: 0.8; }
      100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
    }
    /* çˆ±å¿ƒæ¼‚æµ®åŠ¨ç”» */
    @keyframes heartFloat {
      0% { transform: translateY(100vh) rotate(0deg) scale(1); opacity: 1; }
      50% { transform: translateY(50vh) rotate(15deg) scale(1.3); opacity: 0.8; }
      100% { transform: translateY(-100vh) rotate(30deg) scale(0.8); opacity: 0; }
    }
    /* å¼¹çª—é€æ˜åŒ–ï¼ˆæ¥å—åï¼‰ */
    .popup.fade-out {
      opacity: 0.2;
      pointer-events: none;
    }
    /* æ¥å—åæ ‡è¯­æ ·å¼ï¼ˆæ›´é†’ç›®ï¼‰ */
    .final-title {
      position: fixed;
      top: 20%;
      left: 50%;
      transform: translateX(-50%);
      font-size: 42px;
      color: #ff3e78;
      font-weight: bold;
      text-shadow: 0 0 15px #ff3e78, 0 2px 4px rgba(0,0,0,0.3);
      z-index: 10001;
      transition: all 1s ease;
    }
  </style>
</head>
<body>
  <!-- å…¨å±å¼¹çª— -->
  <div class="popup" id="popup">
    <h2 class="title" id="title">ç‹æ¬£æ€¡ï¼Œæˆ‘ä»¬è§ä¸€é¢å¥½ä¸å¥½ï¼Ÿ</h2>
    <div class="content-wrapper" id="contentWrapper">
      <div class="emoji" id="emoji">ğŸ˜Š</div>
      <button class="btn accept-btn" id="acceptBtn">æ¥å—</button>
    </div>
    <button class="btn refuse-btn" id="refuseBtn">æ‹’ç»</button>
  </div>

  <script>
    const popup = document.getElementById('popup');
    const title = document.getElementById('title');
    const contentWrapper = document.getElementById('contentWrapper');
    const emoji = document.getElementById('emoji');
    const acceptBtn = document.getElementById('acceptBtn');
    const refuseBtn = document.getElementById('refuseBtn');
    let clickCount = 0;
    const maxMoveCount = 1; // ä»…ç§»åŠ¨1æ¬¡
    const maxScaleCount = 2; // ä»…æ”¾å¤§2æ¬¡
    const moveStep = 100; // å•æ¬¡ç§»åŠ¨è·ç¦»
    const scaleStep = 0.6; // æ¯æ¬¡æ”¾å¤§å€æ•°
    let heartInterval = null; // çˆ±å¿ƒå¾ªç¯å®šæ—¶å™¨

    // æ ‡è¯­æ˜ å°„ï¼ˆæŒ‰æ‹’ç»æ¬¡æ•°åˆ‡æ¢ï¼‰
    const titleMap = [
      'ç‹æ¬£æ€¡ï¼Œæˆ‘ä»¬è§ä¸€é¢å¥½ä¸å¥½ï¼Ÿ', // åˆå§‹
      'ç‹æ¬£æ€¡æˆ‘å¥½æƒ³ä½ ', // ç¬¬1æ¬¡æ‹’ç»
      'ç‹æ¬£æ€¡ï¼Œä¸è¦æ‹’ç»å¥½ä¸å¥½ï¼Ÿ', // ç¬¬2æ¬¡æ‹’ç»
      'ç‹æ¬£æ€¡ï¼Œæ²¡æœ‰ä½ æˆ‘çœŸçš„ä¸è¡Œ' // ç¬¬3æ¬¡åŠä»¥åæ‹’ç»
    ];

    // è¡¨æƒ…æ˜ å°„
    const fixedEmojis = ['ğŸ˜Š', 'ğŸ¥º', 'ğŸ˜ ', 'ğŸ˜­']; // 0:åˆå§‹ 1:å§”å±ˆ 2:ä¸é«˜å…´ 3:å“­è„¸
    const randomEmojis = ['ğŸ˜¢', 'ğŸ˜¤', 'ğŸ˜£', 'ğŸ˜¥', 'ğŸ˜©', 'ğŸ˜«', 'ğŸ™â€â™€ï¸', 'ğŸ™']; // ç¬¬4æ¬¡åŠä»¥åéšæœº

    // ç”Ÿæˆé›ªèŠ±ï¼ˆç‚¹å‡»æ‹’ç»æ—¶è§¦å‘ï¼Œå•æ¬¡é£˜é›ªï¼‰
    function createSnowflake() {
      const snowflake = document.createElement('div');
      snowflake.className = 'snowflake';
      snowflake.innerText = 'â„ï¸';
      snowflake.style.left = `${Math.random() * 100}vw`;
      snowflake.style.fontSize = `${12 + Math.random() * 10}px`;
      snowflake.style.animationDuration = `${3 + Math.random() * 5}s`;
      document.body.appendChild(snowflake);
      setTimeout(() => snowflake.remove(), 8000);
    }

    // ç”Ÿæˆçˆ±å¿ƒï¼ˆæ¥å—åæŒç»­é£˜ï¼‰
    function createHeart() {
      const heart = document.createElement('div');
      heart.className = 'heart';
      heart.innerText = 'ğŸ’“';
      heart.style.left = `${Math.random() * 100}vw`;
      heart.style.fontSize = `${16 + Math.random() * 20}px`;
      heart.style.animationDuration = `${3 + Math.random() * 3}s`;
      document.body.appendChild(heart);
      setTimeout(() => heart.remove(), 6000);
    }

    // æ‹’ç»æŒ‰é’®ç‚¹å‡»äº‹ä»¶
    refuseBtn.addEventListener('click', () => {
      clickCount++;
      const currentCount = Math.min(clickCount, 3); // è¶…è¿‡3æ¬¡æŒ‰ç¬¬3æ¬¡å¤„ç†

      // 1. åˆ‡æ¢æ ‡è¯­
      title.innerText = titleMap[currentCount];

      // 2. åˆ‡æ¢è¡¨æƒ…
      if (clickCount <= 3) {
        emoji.innerText = fixedEmojis[currentCount];
      } else {
        const randomIdx = Math.floor(Math.random() * randomEmojis.length);
        emoji.innerText = randomEmojis[randomIdx];
      }

      // 3. è¡¨æƒ…+æ¥å—æŒ‰é’®ç§»åŠ¨ï¼ˆä»…1æ¬¡ï¼‰
      if (clickCount <= maxMoveCount) {
        contentWrapper.style.transform = `translateX(-${clickCount * moveStep}px)`;
      }

      // 4. æ‹’ç»æŒ‰é’®æ”¾å¤§ï¼ˆä»…2æ¬¡ï¼‰
      if (clickCount <= maxScaleCount) {
        const newScale = 1 + (clickCount * scaleStep);
        refuseBtn.style.transform = `translateY(-50%) scale(${newScale})`;
      }

      // 5. ç”Ÿæˆé›ªèŠ±ï¼ˆæ¯æ¬¡ç‚¹å‡»æ‹’ç»é£˜20ç‰‡ï¼Œå•æ¬¡è§¦å‘ï¼‰
      for (let i = 0; i < 20; i++) {
        setTimeout(() => createSnowflake(), i * 80);
      }
    });

    // æ¥å—æŒ‰é’®ç‚¹å‡»äº‹ä»¶
    acceptBtn.addEventListener('click', () => {
      // 1. åˆ‡æ¢è¡¨æƒ…å’Œæ ‡è¯­
      emoji.innerText = 'ğŸ˜†';
      title.innerText = 'ç‹æ¬£æ€¡ï¼Œä½ å®šæ—¶é—´ï¼Œç„¶åç§å‘ç»™æˆ‘å“ˆ';
      title.classList.add('final-title'); // å•ç‹¬æ ·å¼ï¼Œæ›´é†’ç›®

      // 2. å¼¹çª—é€æ˜åŒ–
      popup.classList.add('fade-out');

      // 3. å¯åŠ¨çˆ±å¿ƒæŒç»­å¾ªç¯ï¼ˆæ»¡å±æ•ˆæœï¼‰
      heartInterval = setInterval(createHeart, 200);
    });

    // ç¦æ­¢æ‰€æœ‰å¼ºåˆ¶é€€å‡ºæ–¹å¼
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' || e.key === 'Backspace') {
        e.preventDefault();
        refuseBtn.click();
      }
    });
    document.addEventListener('contextmenu', (e) => e.preventDefault());
    window.addEventListener('popstate', (e) => {
      e.preventDefault();
      refuseBtn.click();
    });
    history.pushState(null, null, document.URL);
    document.addEventListener('dblclick', (e) => e.preventDefault());
  </script>
</body>
</html>